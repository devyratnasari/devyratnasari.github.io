<!DOCTYPE HTML>
<!--
	Hyperspace by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<link rel="icon" type="image/x-icon" href="/assets/css/images/title.png">
		<title>Bonds</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>	
	</head>
	<body class="is-preload">

		<!-- Header -->
		<section id="header">
			<div class="inner" style="padding-left: 5em;">
				<a href="index.html" class="title" style="font-size: x-large;"><h2>DR</h2></a>
			</div>
			<nav>
				<ul>
					<li><div class="dropdown">
						<a href="#eda">EDA</a> 
						<div class="dropdown-content">
							<a href="#eda">User</a>
							<a href="#dataset2">Transaction</a>
							<a href="#dataset3">Bonds Order</a>
						</div>
					</div>
					</li>
					<li><a href="#preprocessing">Preprocessing</a></li>
					<li><div class="dropdown">
						<a href="#eda">Models</a> 
						<div class="dropdown-content">
							<a href="#logreg1">Logistic Regression</a>
						</div>
					</div>
					<li><a href="index.html">Back to projects</a></li>
				</ul>
			</nav>
		</section>


		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<section id="dataset" class="wrapper">
						<div class="inner" style="font-size: large;">
							<h1 class="major">Government bonds buyer predictions</h1>
							<p style="font-size: large;">The analysis is conducted to predict how much government bonds the company has to order based on the users behaviour.
								The dataset is sourced from Indonesia Fintech StartUp between August and October 2021.
								There are 3 datasets that the company provided:
								<ol style="font-size: large;">
									<li><b>Users information</b>  <br>
										This dataset contains:
										<ul style="list-style-type: circle;">
											<li>user_id - User's identity</li>
											<li>registration_import_datetime - Date of user registered</li>
											<li>user_gender - Gender of the user</li>
											<li>user_age - Age of the user</li>
											<li>user_occupation - Occupation of the user</li>
											<li>user_income_range - Range income of the user</li>
											<li>referral_code_used - If the user using referral code during registration or not</li>
											<li>user_income_source - The source of income from the user</li>
										</ul>
										<table>
											<thead>
												<tr style="text-align: right;">
												  <th></th>
												  <th>user_id</th>
												  <th>registration_import_datetime</th>
												  <th>user_gender</th>
												  <th>user_age</th>
												  <th>user_occupation</th>
												  <th>user_income_range</th>
												  <th>referral_code_used</th>
												  <th>user_income_source</th>
												</tr>
											  </thead>
											  <tbody>
												<tr>
												  <th>0</th>
												  <td>162882</td>
												  <td>2021-09-17</td>
												  <td>Female</td>
												  <td>51</td>
												  <td>Swasta</td>
												  <td>&gt; Rp 500 Juta - 1 Miliar</td>
												  <td>NaN</td>
												  <td>Gaji</td>
												</tr>
												<tr>
												  <th>1</th>
												  <td>3485491</td>
												  <td>2021-10-09</td>
												  <td>Female</td>
												  <td>55</td>
												  <td>Others</td>
												  <td>&gt; Rp 50 Juta - 100 Juta</td>
												  <td>NaN</td>
												  <td>Gaji</td>
												</tr>
												<tr>
												  <th>2</th>
												  <td>1071649</td>
												  <td>2021-10-08</td>
												  <td>Male</td>
												  <td>50</td>
												  <td>Swasta</td>
												  <td>Rp 10 Juta - 50 Juta</td>
												  <td>NaN</td>
												  <td>Gaji</td>
												</tr>
												<tr>
												  <th>3</th>
												  <td>3816789</td>
												  <td>2021-08-12</td>
												  <td>Female</td>
												  <td>53</td>
												  <td>IRT</td>
												  <td>&gt; Rp 50 Juta - 100 Juta</td>
												  <td>NaN</td>
												  <td>Gaji</td>
												</tr>
												<tr>
												  <th>4</th>
												  <td>3802293</td>
												  <td>2021-08-15</td>
												  <td>Female</td>
												  <td>47</td>
												  <td>PNS</td>
												  <td>&gt; Rp 500 Juta - 1 Miliar</td>
												  <td>used referral</td>
												  <td>Gaji</td>
												</tr>
											  </tbody>
										</table>
									</li>
									<li><b>Users's daily transaction</b><br>
										This dataset contains:
										<ul style="list-style-type: circle;">
											<li>user_id - Id of user, it's same with the user_id from dataset 1</li>
											<li>date - Transaction date</li>
											<li>Saham_AUM - AUM (Assets Under Management) of equity mutual fund held by client to date</li>
											<li>Saham_invested_amount - The total price paid by client to buy equity mutual fund to date.</li>
											<li>Saham_transaction_amount - Total value of transaction to buy (if positive) or sell (if negative) equity mutual fund on the date.</li>
											<li>Pasar_Uang_AUM - AUM of money market mutual fund held by client to date</li>
											<li>Pasar_Uang_invested_amount - The total price paid by client to buy money market mutual fund to date</li>
											<li>Pasar_Uang_transaction_amount - Total value of transaction to buy (if positive) or sell (if negative) money market mutual fund on the date. </li>
											<li>Pendapatan_Tetap_AUM - AUM of fixed income mutual fund held by client to date</li>
											<li>Pendapatan_Tetap_invested_amount - The total price paid by client to buy fixed income mutual fund to date</li>
											<li>Pendapatan_Tetap_transaction_amount - Total value of transaction to buy (if positive) or sell (if negative) fixed income mutual fund on the date.</li>
											<li>Campuran_AUM - AUM of mixed mutual fund held by client to date</li>
											<li>Campuran_invested_amount - The total price paid by client to buy mixed mutual fund to date</li>
											<li>Campuran_transaction_amount - Total value of transaction to buy (if positive) or sell (if negative) mixed mutual fund on the date.</li>
										<div style="overflow-x: auto; margin-top: 1em;">
											<table>
												<thead>
													<tr style="text-align: right;">
													  <th></th>
													  <th>user_id</th>
													  <th>trans_date</th>
													  <th>Saham_AUM</th>
													  <th>Saham_invested_amount</th>
													  <th>Saham_transaction_amount</th>
													  <th>Pasar_Uang_AUM</th>
													  <th>Pasar_Uang_invested_amount</th>
													  <th>Pasar_Uang_transaction_amount</th>
													  <th>Pendapatan_Tetap_AUM</th>
													  <th>Pendapatan_Tetap_invested_amount</th>
													  <th>Pendapatan_Tetap_transaction_amount</th>
													  <th>Campuran_AUM</th>
													  <th>Campuran_invested_amount</th>
													  <th>Campuran_transaction_amount</th>
													</tr>
												  </thead>
												  <tbody>
													<tr>
													  <th>0</th>
													  <td>50701</td>
													  <td>2021-08-30</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>10132277.0</td>
													  <td>10000000.0</td>
													  <td>0.0</td>
													</tr>
													<tr>
													  <th>1</th>
													  <td>50701</td>
													  <td>2021-08-31</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>10206945.0</td>
													  <td>10000000.0</td>
													  <td>0.0</td>
													</tr>
													<tr>
													  <th>2</th>
													  <td>50701</td>
													  <td>2021-09-01</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>9956556.0</td>
													  <td>10000000.0</td>
													  <td>0.0</td>
													</tr>
													<tr>
													  <th>3</th>
													  <td>50701</td>
													  <td>2021-09-02</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>9914858.0</td>
													  <td>10000000.0</td>
													  <td>0.0</td>
													</tr>
													<tr>
													  <th>4</th>
													  <td>50701</td>
													  <td>2021-09-03</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>0.0</td>
													  <td>10016360.0</td>
													  <td>10000000.0</td>
													  <td>0.0</td>
													</tr>
												  </tbody>
											</table>
										</div>
										</ul>
									</li>
									<li><b>Bonds history purchase</b><br>This dataset contains:
										<ul style="list-style: circle;">
											<li>user_id - ID of the user, same as dataset 1 and 2</li>
											<li>flag_order_bond - 1 if the user ordered bonds, 0 for the opposite</li>
											<li>bond_units_ordered - The total of bond that user ordered</li>
										</ul>
										<table>
											<thead>
												<tr style="text-align: right;">
												  <th></th>
												  <th>user_id</th>
												  <th>flag_order_bond</th>
												  <th>bond_units_ordered</th>
												</tr>
											  </thead>
											  <tbody>
												<tr>
												  <th>0</th>
												  <td>50701</td>
												  <td>1</td>
												  <td>34</td>
												</tr>
												<tr>
												  <th>1</th>
												  <td>50961</td>
												  <td>1</td>
												  <td>99</td>
												</tr>
												<tr>
												  <th>2</th>
												  <td>51883</td>
												  <td>0</td>
												  <td>0</td>
												</tr>
												<tr>
												  <th>3</th>
												  <td>53759</td>
												  <td>0</td>
												  <td>0</td>
												</tr>
												<tr>
												  <th>4</th>
												  <td>54759</td>
												  <td>1</td>
												  <td>92</td>
												</tr>
											  </tbody>
										</table>
									</li>
								</ol>
							</p>
								<section><h2 class="major"id="eda">Users</h2>
								<p><div class="desc">We want to see how much the total of data that we have and the datatype, if there are any duplicate in our data, null value or any other problem that we need to taking care of.</div>
									<pre><code>print(f'Total Row: {user.shape[0]} , Column: {user.shape[1]}')
user.info()</code></pre>
	<pre>	Total Row: 14712 , Column: 8
	RangeIndex: 14712 entries, 0 to 14711
	Data columns (total 8 columns):
	#   Column                        Non-Null Count  Dtype    
	---  ------                        --------------  -----    
	0   user_id                       14712 non-null  int64    
	1   registration_import_datetime  14712 non-null  period[D]
	2   user_gender                   14712 non-null  object   
	3   user_age                      14712 non-null  int64    
	4   user_occupation               14712 non-null  object   
	5   user_income_range             14712 non-null  object   
	6   referral_code_used            5604 non-null   object   
	7   user_income_source            14712 non-null  object   
	dtypes: int64(2), object(5), period[D](1)</pre>
<div class="desc">There are 14712 rows of data with 8 columns for the dataset 1, we can see that on the column referral_code_used there are only 5604 rows of non-null data
	the next step that we will do is to double check null value in the dataset and if any duplicate user_id since the user_id is our primary key.</div>
	<pre><code>is_duplicate_user = user.user_id.duplicated().sum()
total_user = user.user_id.count()
print(f'Total Duplicate User_ID : {is_duplicate_user}')
print(f'Total User : {total_user}')
user.isnull().sum()</code></pre>
	<pre>	Total Duplicate User_ID : 0
	Total User : 14712
	user_id                            0
	registration_import_datetime       0
	user_gender                        0
	user_age                           0
	user_occupation                    0
	user_income_range                  0
	referral_code_used              9108
	user_income_source                 0
	dtype: int64</pre>
<div class="desc">From the result above, it's confirmed that we have 9108 rows of null value in column referral_code_used
	and luckily we don't have any duplicate data for the user_id so we can continue to decide what to do with the null value.
	We will be checking for the unique value from each column in the dataset to help us deciding what to replace the null value with.</div>
<pre><code>for x in user:
	uniqueValues = user[x].unique()
	n_values = len(uniqueValues)
	if n_values <=50:
	print(f'Column: {x} -- total unique value: ({n_values}) {uniqueValues}')</code></pre>
<pre style="overflow-x: auto;">	Column: user_gender -- total unique value: (2) ['Female' 'Male']
	Column: user_occupation -- total unique value: (9) ['Swasta' 'Others' 'IRT' 'PNS' 'Pengusaha' 'Pensiunan' 'TNI/Polisi' 'Guru''Pelajar']
	Column: user_income_range -- total unique value: (6) ['> Rp 500 Juta - 1 Miliar' '> Rp 50 Juta - 100 Juta' 'Rp 10 Juta - 50 Juta' '< 10 Juta' '> Rp 100 Juta - 500 Juta' '> Rp 1 Miliar']
	Column: referral_code_used -- total unique value: (2) [nan 'used referral']
	Column: user_income_source -- total unique value: (10) ['Gaji' 'Keuntungan Bisnis' 'Lainnya' 'Dari Orang Tua / Anak' 'Undian' 'Tabungan' 'Warisan' 'Hasil Investasi' 'Dari Suami / istri' 'Bunga Simpanan']
	</pre>
	By checking the unique value, we can see the categorical data of each column. We notice that there are only 2 category from referral_code_used, which is nan or 'used referral'.
	We will be converting the null value to none instead of nan or deleting the data.
	<pre><code>user.referral_code_used.fillna('None', inplace = True)
user.referral_code_used.unique()
user.isnull().sum()</code></pre>
	<pre style="overflow-x: auto;">	array(['None', 'used referral'], dtype=object)
	user_id                         0
	registration_import_datetime    0
	user_gender                     0
	user_age                        0
	user_occupation                 0
	user_income_range               0
	referral_code_used              0
	user_income_source              0
	dtype: int64
	</pre>
	We succesfully convert the null value to none. Then we will start our analysis by checking the user registration growth between August and October 2021.
	We will visualise the chart by daily and monthly registration.
	<pre><code>user['registration_import_datetime'].value_counts().sort_index().plot()
plt.title('User Join Growth by Day')
user['registration_month'] = user.registration_import_datetime.dt.to_timestamp('m').copy()
user.registration_month.value_counts().sort_index().plot()
plt.title('User Join Growth by Month')
plt.show()</code></pre>
	<img src="/images/bonds/user_growth_linechart.png" alt="" class="vis"> <img src="/images/bonds/user_month.png" alt=""  class="vis">
	<div class="desc">In the daily registration chart, we can see that October is the month with the lowest and highest number of registration,
		meanwhile when we try to visualise by monthly basis we can see that September is the month with the highest number of registration, around 5200 users signed up.
		Next, we want to see the comparison by user's gender.</div>
	<pre><code>gender = user[['user_id', 'user_gender']].groupby('user_gender').count()
plt.pie(gender.user_id, labels=gender.index , startangle=90, shadow=True,explode=(0.1, 0.1), autopct='%1.2f%%')
plt.title('Users\' Gender Distribution')
plt.show()			</code></pre>	
<div class="center"><img src="/images/bonds/user_gender.png" alt="" class="center"></div>
<div class="desc">The user's gender distribution chart show that around 61.02% of our users are male, meanwhile the rest are female.
	Then we will try to visualise the user's range and source of income to see more details of it.
</div>
<pre><code>fig, ax = plt.subplots(figsize=(8, 8), subplot_kw=dict(aspect="equal"))
income_source = user[['user_id', 'user_income_source']].groupby('user_income_source').count
def func(pct, allvals):
	absolute = int(np.round(pct/100.*np.sum(allvals)))
	return "{:.1f}%\n({:d} users)".format(pct, absolute)

wedges, texts, autotexts = ax.pie(income_source.user_id, autopct=lambda pct: func(pct, income_source.user_id),
	textprops=dict(color="black"), explode=(1,0,0,0,0,0,0,0,0,0))
ax.legend(wedges, income_source.index,
	title="Income Source",
	loc="upper left",
	bbox_to_anchor=(1, 0, 0.5, 1))
plt.setp(autotexts, size=8, weight="bold")
ax.set_title("User's Income Source")
plt.show()			</code></pre>	
<div class="center"><img src="/images/bonds/user_income_source.png" alt=""></div>
<div class="desc">We read the chart counterclockwise start from the exploded pie.
	It shows that the lowest income source is from Bunga Simpanan (Saving's interest) with 0.2%.
whilst the majority of the income source is from Gaji (Salary) with 62.1% or equal to 9131 users.
Then we will see for the user's income range.</div>
<pre><code>fig, ax = plt.subplots(figsize=(6, 5))
ax = sns.countplot(y= user.user_income_range, data = user)

ax.set_title('User Income Range')
for x in ax.containers:
	ax.bar_label(x, label_type='edge')

plt.show()			</code></pre>
<div class="center"><img src="/images/bonds/user_income_range.png" alt="" class="center"></div>
<div class="desc">In the user income range chart, it shows the majority of user's income range is less than 10 Million Rupiah (approx 630USD) with 6275 users.
	Nevertheless, there are 27 users with the highest income range - 1 Billion Rupiah (approx 63000USD) which is our potential big investor.
	We also, will try to combine between income source and range to see the breakdown of it.
</div>	
<pre><code>fig, ax = plt.subplots(figsize=(12, 8))
ax = sns.countplot(y= user.user_income_source, hue=user.user_income_range, data = user)
ax.set_title('Income source and range')
for x in ax.containers:
	ax.bar_label(x, label_type='edge')
ax.legend(loc='best', fontsize=8)
plt.show()</code></pre>
<div class="center"><img src="/images/bonds/income_source_range.png" alt=""></div>
<div class="desc">The income range and source chart, we can see there are 2835 of our users had wages less than 10 Million Rupiah.
	Moreover, the majority of our user's salary income range is between 10 Million to 50 Million Rupiah with the total of 3483 users.
	We can also notice that there are 10 of users had salary more than 1 Billion Rupiah. We will try to visualise the distribution of our user's occupation.
</div>
<pre><code>fig, ax = plt.subplots(figsize=(10, 5))
ax =sns.countplot(x=user.user_occupation)
for x in ax.containers:
	ax.bar_label(x, label_type='edge')
ax.set_title('User occupation')
plt.show()</code></pre>
<div class="center"><img src="/images/bonds/occupation.png" alt=""></div>
<div class="desc">The users' occupation chart shows that the majority of our users are Pelajar (Student) with total of 7887 user.
	Which is make sense that our majority income range is less than 10 Million.
	We will try to combine the income range and user occupation to see more details of it.</div>
<pre><code>fig, ax = plt.subplots(figsize=(12, 8))
ax = sns.countplot(y= user.user_occupation, hue=user.user_income_range, data = user)
ax.set_title('Income range and occupation')
for x in ax.containers:
	ax.bar_label(x, label_type='edge')
ax.legend(loc='right', fontsize=8)
plt.show()</code></pre>
<div class="center"><img src="/images/bonds/income_range_occupation.png" alt=""></div>
<div class="desc">When we combined the income range and occupation, we found an interesting information that we have 17 students with income range more than 500 Million Rupiah.
	So we will investigate a little bit further about the 17 students.
</div>
<pre><code>pelajar_age = user.query('user_occupation == \'Pelajar\' and (user_income_range == \'> Rp 500 Juta - 1 Miliar\'
	sor user_income_range == \'> Rp 1 Miliar\')')</code></pre>
<table id="pelajar" style="overflow-y: scroll;">
	<thead>
		<tr style="text-align: right;">
		  <th></th>
		  <th>user_id</th>
		  <th>registration_import_datetime</th>
		  <th>user_gender</th>
		  <th>user_age</th>
		  <th>user_occupation</th>
		  <th>user_income_range</th>
		  <th>referral_code_used</th>
		  <th>user_income_source</th>
		  <th>registration_month</th>
		</tr>
	  </thead>
	  <tbody>
		<tr>
		  <th>619</th>
		  <td>4228712</td>
		  <td>2021-10-05</td>
		  <td>Male</td>
		  <td>17</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 1 Miliar</td>
		  <td>used referral</td>
		  <td>Keuntungan Bisnis</td>
		  <td>2021-10-31</td>
		</tr>
		<tr>
		  <th>899</th>
		  <td>3795261</td>
		  <td>2021-08-08</td>
		  <td>Male</td>
		  <td>18</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 1 Miliar</td>
		  <td>used referral</td>
		  <td>Lainnya</td>
		  <td>2021-08-31</td>
		</tr>
		<tr>
		  <th>1394</th>
		  <td>4376258</td>
		  <td>2021-10-19</td>
		  <td>Male</td>
		  <td>18</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 500 Juta - 1 Miliar</td>
		  <td>used referral</td>
		  <td>Gaji</td>
		  <td>2021-10-31</td>
		</tr>
		<tr>
		  <th>2282</th>
		  <td>3818578</td>
		  <td>2021-08-16</td>
		  <td>Male</td>
		  <td>19</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 1 Miliar</td>
		  <td>None</td>
		  <td>Keuntungan Bisnis</td>
		  <td>2021-08-31</td>
		</tr>
		<tr>
		  <th>2609</th>
		  <td>3742646</td>
		  <td>2021-08-09</td>
		  <td>Female</td>
		  <td>20</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 1 Miliar</td>
		  <td>None</td>
		  <td>Keuntungan Bisnis</td>
		  <td>2021-08-31</td>
		</tr>
		<tr>
		  <th>3999</th>
		  <td>3749935</td>
		  <td>2021-08-04</td>
		  <td>Female</td>
		  <td>21</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 1 Miliar</td>
		  <td>None</td>
		  <td>Keuntungan Bisnis</td>
		  <td>2021-08-31</td>
		</tr>
		<tr>
		  <th>4076</th>
		  <td>4245492</td>
		  <td>2021-10-07</td>
		  <td>Female</td>
		  <td>21</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 500 Juta - 1 Miliar</td>
		  <td>None</td>
		  <td>Keuntungan Bisnis</td>
		  <td>2021-10-31</td>
		</tr>
		<tr>
		  <th>4569</th>
		  <td>4355874</td>
		  <td>2021-10-17</td>
		  <td>Male</td>
		  <td>21</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 1 Miliar</td>
		  <td>used referral</td>
		  <td>Keuntungan Bisnis</td>
		  <td>2021-10-31</td>
		</tr>
		<tr>
		  <th>6135</th>
		  <td>4239037</td>
		  <td>2021-10-06</td>
		  <td>Female</td>
		  <td>23</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 500 Juta - 1 Miliar</td>
		  <td>used referral</td>
		  <td>Gaji</td>
		  <td>2021-10-31</td>
		</tr>
		<tr>
		  <th>8322</th>
		  <td>4371352</td>
		  <td>2021-10-19</td>
		  <td>Male</td>
		  <td>25</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 500 Juta - 1 Miliar</td>
		  <td>used referral</td>
		  <td>Gaji</td>
		  <td>2021-10-31</td>
		</tr>
		<tr>
		  <th>8871</th>
		  <td>3959126</td>
		  <td>2021-09-02</td>
		  <td>Female</td>
		  <td>26</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 500 Juta - 1 Miliar</td>
		  <td>used referral</td>
		  <td>Keuntungan Bisnis</td>
		  <td>2021-09-30</td>
		</tr>
		<tr>
		  <th>9063</th>
		  <td>4342801</td>
		  <td>2021-10-17</td>
		  <td>Male</td>
		  <td>26</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 500 Juta - 1 Miliar</td>
		  <td>None</td>
		  <td>Gaji</td>
		  <td>2021-10-31</td>
		</tr>
		<tr>
		  <th>9725</th>
		  <td>4270298</td>
		  <td>2021-10-09</td>
		  <td>Female</td>
		  <td>27</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 500 Juta - 1 Miliar</td>
		  <td>None</td>
		  <td>Keuntungan Bisnis</td>
		  <td>2021-10-31</td>
		</tr>
		<tr>
		  <th>10101</th>
		  <td>4134537</td>
		  <td>2021-09-24</td>
		  <td>Male</td>
		  <td>28</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 500 Juta - 1 Miliar</td>
		  <td>None</td>
		  <td>Keuntungan Bisnis</td>
		  <td>2021-09-30</td>
		</tr>
		<tr>
		  <th>10925</th>
		  <td>4338825</td>
		  <td>2021-10-15</td>
		  <td>Male</td>
		  <td>29</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 1 Miliar</td>
		  <td>used referral</td>
		  <td>Lainnya</td>
		  <td>2021-10-31</td>
		</tr>
		<tr>
		  <th>11617</th>
		  <td>4164878</td>
		  <td>2021-10-02</td>
		  <td>Male</td>
		  <td>31</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 500 Juta - 1 Miliar</td>
		  <td>used referral</td>
		  <td>Keuntungan Bisnis</td>
		  <td>2021-10-31</td>
		</tr>
		<tr>
		  <th>11950</th>
		  <td>3858112</td>
		  <td>2021-08-18</td>
		  <td>Female</td>
		  <td>32</td>
		  <td>Pelajar</td>
		  <td>&gt; Rp 500 Juta - 1 Miliar</td>
		  <td>None</td>
		  <td>Gaji</td>
		  <td>2021-08-31</td>
		</tr>
	  </tbody>
</table>
<div class="desc">It's interesting that we have few users with age below 20, as a student with income range above 500 Million Rupiah and the income source is from business profit.
	There is a possibility with the wrong information that the user provided or they might born with a silver spoon.
	However, we just leave it as is for now and take notes just in case we might need some adjustment prior building the model.
The next thing we want to check is, how many percent of our user registered using referral code.
This might also will help to decide what type of campaigne approach to increase the registration number.</div>
<pre><code>referral_code = user[['user_id', 'referral_code_used']].groupby('referral_code_used').count()
plt.pie(referral_code.user_id, labels=referral_code.index, startangle=90, shadow=True,explode=(0.1, 0.1), autopct='%1.2f%%')
plt.title('Referral Code Comparison')
plt.show()</code></pre>
<div class="center"><img src="/images/bonds/referral_code.png" alt=""></div>
<div class="desc">We can see from the referral code comparison that only 38.09% of our users using referral code during their registration process.
	We can create an announcement on the company website or application about bonus credit if the user refer some friends to register with us.
	This will increase the number of new users, transactions, also a cheaper version of advertisement as we announce it using our private platform so third party advertisement cost needed.
	As well as encourage the current users to make more transaction using the bonus credit and so on.
	We will check the average age of our users.
</div>
<pre><code>user['user_age'].describe()</code>
	count    14712.000000
	mean        27.176591
	std          8.552585
	min         17.000000
	25%         21.000000
	50%         25.000000
	75%         31.000000
	max         83.000000
	Name: user_age, dtype: float64</pre>
	<div class="desc">The description show that the average age of our user is 27 years old. With the youngest is 17 and oldest is 83 years old.
		We will try to visualise the distribution of it by using histogram.
	</div>
	<pre><code>user['user_age'].hist(figsize = (5,5))
plt.title('User age distribution')</code></pre>
	<div class="center"><img src="/images/bonds/age_histogram.png" alt=""></div>
	<div class="desc">The histogram show that most of our users are in age group 20's and 30's.
		The next step we will do is using zscore to calculate if there's any outliers.</div>
<pre><code>mean = np.mean(user.user_age)
std = np.std(user.user_age)
outlier = []
for i in user.user_age:
	z = (i-mean)/std
	if z > 3:
		outlier.append(i)
print('outliers in dataset are', set(outlier))
sns.boxplot(x=user.user_age)</code>
	outliers in dataset are {53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 69, 71, 73, 74, 76, 82, 83}</pre>
<div class="center"><img src="/images/bonds/outliers.png" alt=""></div>
<div class="desc">From the z-score calculation, it shows the ourliers from the users age are from 53 years and older.
	We will visualise the distribution and check how many users are in the outliers then merging the dataset 1 and transactions' dataset to see how many percentage of the outlier's user contribute with transaction before we decide to remove the outliers or just leave it as is.</div>
<pre><code>user_outliers = user.loc[user.user_age>=53,:]
total_out = user_outliers.user_id.count()
percentage_outliers = (total_out/total_user)
print(f'Total users in outliers : {total_out} OR {percentage_outliers:.2%} from total user')
fig, ax = plt.subplots(figsize=(6, 5))
ax = sns.countplot(y= user_outliers.user_age, data = user_outliers)
ax.set_title('User distribution above 53 years of age')
for x in ax.containers:
	ax.bar_label(x, label_type='edge')
plt.show()</code>
	Total users in outliers : 264 OR 1.79% from total user</pre>
<div class="center"><img src="/images/bonds/outliers_dist.png" alt=""></div>
<div class="desc">The chart above shows that we have the total of 264 users in the outliers category or equal to 1.79% from the total user.
	With the highest distribution on 54 years of age and lowest start from 73 years. Since the age outliers still in the normal scope, we will keep the users from 54 years of age and older included with our analysis.
</div></section>
<h2 class="major" id="dataset2">Transactions</h2>
<div class="desc">We want to check how many rows of data that we have on transactions' dataset and the total number of users that making transactions.</div>
<pre><code>print(f'Total rows: {trans.shape[0]} ,columns: {trans.shape[1]}')
transcation_users = trans['user_id'].nunique()
print(f'Total users making transaction period August - October 2021 = {transcation_users} users
	or {(transcation_users/total_user):.2%}')
trans.info()</code>
	Total rows: 158811 ,columns: 14
	Total users making transaction period August - October 2021 = 8277 users or 56.26%
	RangeIndex: 158811 entries, 0 to 158810
	Data columns (total 14 columns):
	#   Column                               Non-Null Count   Dtype  
	---  ------                               --------------   -----  
	0   user_id                              158811 non-null  int64  
	1   date                                 158811 non-null  object 
	2   Saham_AUM                            106292 non-null  float64
	3   Saham_invested_amount                106292 non-null  float64
	4   Saham_transaction_amount             100839 non-null  float64
	5   Pasar_Uang_AUM                       131081 non-null  float64
	6   Pasar_Uang_invested_amount           131081 non-null  float64
	7   Pasar_Uang_transaction_amount        124273 non-null  float64
	8   Pendapatan_Tetap_AUM                 105946 non-null  float64
	9   Pendapatan_Tetap_invested_amount     105946 non-null  float64
	10  Pendapatan_Tetap_transaction_amount  100497 non-null  float64
	11  Campuran_AUM                         5352 non-null    float64
	12  Campuran_invested_amount             5352 non-null    float64
	13  Campuran_transaction_amount          5117 non-null    float64
	dtypes: float64(12), int64(1), object(1)</pre>
	<div class="desc">From the data description above, we can see that there are 158811 rows and 14 column of data in the transactions' dataset.
	Furthermore, it's only 8277 users making transaction or equal to 56.26% from the total users.
	The company can create some campaigne to encourage the new users to make a new transaction.
	In addition, we can see from the data information we have plenty of column contained null value.
	We will check to confirmed this information and change the 'date' column name to trans_date to avoid ambiguity with the method.
	</div>
	<pre><code>trans.rename(columns={"date": "trans_date"}, inplace=True)
trans['trans_date'] = pd.to_datetime(trans['trans_date'])
trans.isnull().sum()</code>
	user_id                                     0
	trans_date                                  0
	Saham_AUM                               52519
	Saham_invested_amount                   52519
	Saham_transaction_amount                57972
	Pasar_Uang_AUM                          27730
	Pasar_Uang_invested_amount              27730
	Pasar_Uang_transaction_amount           34538
	Pendapatan_Tetap_AUM                    52865
	Pendapatan_Tetap_invested_amount        52865
	Pendapatan_Tetap_transaction_amount     58314
	Campuran_AUM                           153459
	Campuran_invested_amount               153459
	Campuran_transaction_amount            153694
	dtype: int64</pre>
	<div class="desc">The information above confirmed our findings, and refer to the dataset information all of the column with the null value is a transactions column.
		So, we will be changing the data to 0 instead of null.</div>
<pre><code>trans.fillna(0, inplace=True)
trans.isnull().sum()</code>
	user_id                                0
	trans_date                             0
	Saham_AUM                              0
	Saham_invested_amount                  0
	Saham_transaction_amount               0
	Pasar_Uang_AUM                         0
	Pasar_Uang_invested_amount             0
	Pasar_Uang_transaction_amount          0
	Pendapatan_Tetap_AUM                   0
	Pendapatan_Tetap_invested_amount       0
	Pendapatan_Tetap_transaction_amount    0
	Campuran_AUM                           0
	Campuran_invested_amount               0
	Campuran_transaction_amount            0
	dtype: int64</pre>
	<div class="desc">The null value has been replaced, the next step we will do find how many times transaction has been made by the user.
		We will create some boolean flag column 1 if the user making transaction on certain dates, and 0 if not. Later we will visualise this columns to see the daily growth.
		</div>
<pre><code>trans['count_saham'] = np.where(trans['Saham_transaction_amount']!=0.00,1,0)
trans['count_uang'] = np.where(trans['Pasar_Uang_transaction_amount']!=0.00,1,0)
trans['count_fixed'] = np.where(trans['Pendapatan_Tetap_transaction_amount']!=0.00,1,0)
trans['count_mixed'] = np.where(trans['Campuran_transaction_amount']!=0.00,1,0)

trans_count = trans[['count_saham', 'count_uang', 'count_fixed', 'count_mixed', 'trans_date']].groupby('trans_date').sum()
t_series = trans_count.index.to_pydatetime()

fig, ax = plt.subplots(figsize=(8, 6))

ax.plot(t_series, trans_count)
plt.title('Total transaction growth per day')
plt.legend(['Saham', 'Pasar Uang', 'Pendapatan Tetap', 'Campuran'])
plt.setp(ax.xaxis.get_ticklabels(), rotation=90)

plt.show()</code></pre>
<div class="center"><img src="/images/bonds/transaction_growth.png" alt=""></div>
<div class="desc">From the number of transactions chart, the higher type of transaction is Pasar Uang (Money Market) follow by Pendapatan Tetap (fixed income) and Saham (stocks) respectively.
	As we can see from the dataset, the AUM and invested amount is updated daily, meanwhile transactions is filled when the users make any buy or sell transactions and it will fill with 0 if no transactions has been made.
	Furthermore, we will be separating buy and sell transactions into new columns, to avoid biased data when summarise the transactions.</div>

<pre><code>trans_buysell = ['Saham_transaction_amount','Pasar_Uang_transaction_amount', 'Pendapatan_Tetap_transaction_amount',
	'Campuran_transaction_amount']

for x in trans_buysell:
	mask = trans[x] < 0
	trans[x+'_buy'] = trans[x].mask(mask).abs()
	trans[x+'_sell'] = trans[x].mask(~mask).abs()

trans.loc[trans.Saham_transaction_amount !=0.00,:].head()</code></pre>
<div class="table-wrapper">
	<table>
		<thead>
			<tr style="text-align: right;">
			  <th></th>
			  <th>user_id</th>
			  <th>trans_date</th>
			  <th>Saham_AUM</th>
			  <th>Saham_invested_amount</th>
			  <th>Saham_transaction_amount</th>
			  <th>Pasar_Uang_AUM</th>
			  <th>Pasar_Uang_invested_amount</th>
			  <th>Pasar_Uang_transaction_amount</th>
			  <th>Pendapatan_Tetap_AUM</th>
			  <th>Pendapatan_Tetap_invested_amount</th>
			  <th>...</th>
			  <th>count_fixed</th>
			  <th>count_mixed</th>
			  <th>Saham_transaction_amount_buy</th>
			  <th>Saham_transaction_amount_sell</th>
			  <th>Pasar_Uang_transaction_amount_buy</th>
			  <th>Pasar_Uang_transaction_amount_sell</th>
			  <th>Pendapatan_Tetap_transaction_amount_buy</th>
			  <th>Pendapatan_Tetap_transaction_amount_sell</th>
			  <th>Campuran_transaction_amount_buy</th>
			  <th>Campuran_transaction_amount_sell</th>
			</tr>
		  </thead>
		  <tbody>
			<tr>
			  <th>25</th>
			  <td>50961</td>
			  <td>2021-09-01</td>
			  <td>1705566.0</td>
			  <td>1700000.0</td>
			  <td>1000000.0</td>
			  <td>100065.0</td>
			  <td>100000.0</td>
			  <td>0.0</td>
			  <td>200124.0</td>
			  <td>200000.0</td>
			  <td>...</td>
			  <td>0</td>
			  <td>0</td>
			  <td>1000000.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			</tr>
			<tr>
			  <th>46</th>
			  <td>50961</td>
			  <td>2021-09-30</td>
			  <td>2063909.0</td>
			  <td>2000000.0</td>
			  <td>300000.0</td>
			  <td>700603.0</td>
			  <td>700000.0</td>
			  <td>600000.0</td>
			  <td>1398998.0</td>
			  <td>1400000.0</td>
			  <td>...</td>
			  <td>1</td>
			  <td>0</td>
			  <td>300000.0</td>
			  <td>NaN</td>
			  <td>600000.0</td>
			  <td>NaN</td>
			  <td>1200000.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			</tr>
			<tr>
			  <th>102</th>
			  <td>61414</td>
			  <td>2021-08-13</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>-10000.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>...</td>
			  <td>0</td>
			  <td>0</td>
			  <td>NaN</td>
			  <td>10000.0</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			</tr>
			<tr>
			  <th>154</th>
			  <td>66145</td>
			  <td>2021-09-29</td>
			  <td>248015.0</td>
			  <td>240000.0</td>
			  <td>140000.0</td>
			  <td>29992.0</td>
			  <td>30000.0</td>
			  <td>0.0</td>
			  <td>129929.0</td>
			  <td>130000.0</td>
			  <td>...</td>
			  <td>0</td>
			  <td>0</td>
			  <td>140000.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			</tr>
			<tr>
			  <th>166</th>
			  <td>67251</td>
			  <td>2021-09-20</td>
			  <td>562777.0</td>
			  <td>570000.0</td>
			  <td>530000.0</td>
			  <td>110065.0</td>
			  <td>110000.0</td>
			  <td>100000.0</td>
			  <td>420268.0</td>
			  <td>420000.0</td>
			  <td>...</td>
			  <td>1</td>
			  <td>0</td>
			  <td>530000.0</td>
			  <td>NaN</td>
			  <td>100000.0</td>
			  <td>NaN</td>
			  <td>370000.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			</tr>
		  </tbody>
	</table>
<pre>5 rows × 26 columns</pre>
</div>
<div class="desc">Since we split the transactions into buy and sell, we will drop the original transaction column.</div>
<pre><code>trans.drop(trans_buysell, axis=1, inplace=True)
trans.head()</code></pre>
<div class="table-wrapper">
	<table>
		<thead>
			<tr style="text-align: right;">
			  <th></th>
			  <th>user_id</th>
			  <th>trans_date</th>
			  <th>Saham_AUM</th>
			  <th>Saham_invested_amount</th>
			  <th>Pasar_Uang_AUM</th>
			  <th>Pasar_Uang_invested_amount</th>
			  <th>Pendapatan_Tetap_AUM</th>
			  <th>Pendapatan_Tetap_invested_amount</th>
			  <th>Campuran_AUM</th>
			  <th>Campuran_invested_amount</th>
			  <th>...</th>
			  <th>count_fixed</th>
			  <th>count_mixed</th>
			  <th>Saham_transaction_amount_buy</th>
			  <th>Saham_transaction_amount_sell</th>
			  <th>Pasar_Uang_transaction_amount_buy</th>
			  <th>Pasar_Uang_transaction_amount_sell</th>
			  <th>Pendapatan_Tetap_transaction_amount_buy</th>
			  <th>Pendapatan_Tetap_transaction_amount_sell</th>
			  <th>Campuran_transaction_amount_buy</th>
			  <th>Campuran_transaction_amount_sell</th>
			</tr>
		  </thead>
		  <tbody>
			<tr>
			  <th>0</th>
			  <td>50701</td>
			  <td>2021-08-30</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>10132277.0</td>
			  <td>10000000.0</td>
			  <td>...</td>
			  <td>0</td>
			  <td>0</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			</tr>
			<tr>
			  <th>1</th>
			  <td>50701</td>
			  <td>2021-08-31</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>10206945.0</td>
			  <td>10000000.0</td>
			  <td>...</td>
			  <td>0</td>
			  <td>0</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			</tr>
			<tr>
			  <th>2</th>
			  <td>50701</td>
			  <td>2021-09-01</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>9956556.0</td>
			  <td>10000000.0</td>
			  <td>...</td>
			  <td>0</td>
			  <td>0</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			</tr>
			<tr>
			  <th>3</th>
			  <td>50701</td>
			  <td>2021-09-02</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>9914858.0</td>
			  <td>10000000.0</td>
			  <td>...</td>
			  <td>0</td>
			  <td>0</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			</tr>
			<tr>
			  <th>4</th>
			  <td>50701</td>
			  <td>2021-09-03</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>0.0</td>
			  <td>10016360.0</td>
			  <td>10000000.0</td>
			  <td>...</td>
			  <td>0</td>
			  <td>0</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			  <td>0.0</td>
			  <td>NaN</td>
			</tr>
		  </tbody>
	</table>
	<pre>5 rows × 22 columns</pre>
</div>
<div class="desc">The next thing is we will visualise the buy sell transactions to see the total amount of transactions growth.</div>
<pre><code>buysell = trans[['Saham_transaction_amount_buy', 'Saham_transaction_amount_sell', 'Pasar_Uang_transaction_amount_buy', 'Pasar_Uang_transaction_amount_sell',
	'Pendapatan_Tetap_transaction_amount_buy', 'Pendapatan_Tetap_transaction_amount_sell','Campuran_transaction_amount_buy', 'Campuran_transaction_amount_sell',
	'trans_date']].groupby('trans_date').sum()
t_series = buysell.index.to_pydatetime()

fig, ax = plt.subplots(figsize=(8, 6))

ax.plot(t_series, buysell)
plt.title('Summaries buying and selling growth per day')
ax.legend(['Saham_transaction_amount_buy', 'Saham_transaction_amount_sell', 'Pasar_Uang_transaction_amount_buy', 'Pasar_Uang_transaction_amount_sell',
'Pendapatan_Tetap_transaction_amount_buy', 'Pendapatan_Tetap_transaction_amount_sell','Campuran_transaction_amount_buy', 'Campuran_transaction_amount_sell'],
bbox_to_anchor=(1,1.05))
plt.setp(ax.xaxis.get_ticklabels(), rotation=90)
plt.ticklabel_format(style='plain', axis='y')

plt.show()</code></pre>
<div class="center"><img src="/images/bonds/buysell_sum.png" alt=""></div>
<div class="desc">The summaries buying and selling chart shows that the total amount of Pendapatan Tetap (Buying) and Pasar Uang (Buying) are leading than other transactions.
	We are also can see that the majority of the transactions are buying, this could meanings that our users more interested into investing their money. <br>
	Since invested columns are updated daily with the last balanced of the users, we will drop the duplicate data and take the latest date.
</div>
<pre><code>invested_col = ['user_id', 'trans_date', 'Saham_AUM', 'Saham_invested_amount', 'Pasar_Uang_AUM',
	'Pasar_Uang_invested_amount', 'Pendapatan_Tetap_AUM', 'Pendapatan_Tetap_invested_amount', 'Campuran_AUM',
	'Campuran_invested_amount']
invested_AUM = trans.sort_values(by='trans_date').drop_duplicates(subset=['user_id'], keep='last').reset_index(drop=True)
invested_AUM = invested_AUM[invested_col].copy()
print(f'Total rows: {invested_AUM.shape[0]}, columns: {invested_AUM.shape[1]}\nInvested:')
invested_AUM.head()</code>
	Total rows: 8277, columns: 10
	Invested:</pre>
	<div class="table-wrapper">
		<table>
			<thead>
				<tr style="text-align: right;">
				  <th></th>
				  <th>user_id</th>
				  <th>trans_date</th>
				  <th>Saham_AUM</th>
				  <th>Saham_invested_amount</th>
				  <th>Pasar_Uang_AUM</th>
				  <th>Pasar_Uang_invested_amount</th>
				  <th>Pendapatan_Tetap_AUM</th>
				  <th>Pendapatan_Tetap_invested_amount</th>
				  <th>Campuran_AUM</th>
				  <th>Campuran_invested_amount</th>
				</tr>
			  </thead>
			  <tbody>
				<tr>
				  <th>0</th>
				  <td>3786300</td>
				  <td>2021-09-30</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				</tr>
				<tr>
				  <th>1</th>
				  <td>3760891</td>
				  <td>2021-09-30</td>
				  <td>258975.00</td>
				  <td>249864.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>553302.00</td>
				  <td>550000.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				</tr>
				<tr>
				  <th>2</th>
				  <td>4096532</td>
				  <td>2021-09-30</td>
				  <td>13803192.00</td>
				  <td>13352136.00</td>
				  <td>2390277.00</td>
				  <td>2387932.00</td>
				  <td>8134491.00</td>
				  <td>8149154.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				</tr>
				<tr>
				  <th>3</th>
				  <td>2836295</td>
				  <td>2021-09-30</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				</tr>
				<tr>
				  <th>4</th>
				  <td>2839273</td>
				  <td>2021-09-30</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>10028.00</td>
				  <td>10000.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				</tr>
			  </tbody>
		</table>
	</div>
<div class="desc">Transactions dataframe:</div>
<pre><code>sum_trans_total = trans.groupby('user_id')[['Saham_transaction_amount_buy',
	'Saham_transaction_amount_sell', 'Pasar_Uang_transaction_amount_buy',
	'Pasar_Uang_transaction_amount_sell',
	'Pendapatan_Tetap_transaction_amount_buy',
	'Pendapatan_Tetap_transaction_amount_sell',
	'Campuran_transaction_amount_buy', 'Campuran_transaction_amount_sell',
'count_saham', 'count_uang', 'count_fixed', 'count_mixed']].sum()
print(f'Total rows:{sum_trans_total.shape[0]}, columns: {sum_trans_total.shape[1]}\nTransactions:')
sum_trans_total.head()</code>
	Total rows:8277, columns: 12
	Transactions:</pre>
<div class="table-wrapper">
	<table>
		<thead>
			<tr style="text-align: right;">
			  <th></th>
			  <th>Saham_transaction_amount_buy</th>
			  <th>Saham_transaction_amount_sell</th>
			  <th>Pasar_Uang_transaction_amount_buy</th>
			  <th>Pasar_Uang_transaction_amount_sell</th>
			  <th>Pendapatan_Tetap_transaction_amount_buy</th>
			  <th>Pendapatan_Tetap_transaction_amount_sell</th>
			  <th>Campuran_transaction_amount_buy</th>
			  <th>Campuran_transaction_amount_sell</th>
			  <th>count_saham</th>
			  <th>count_uang</th>
			  <th>count_fixed</th>
			  <th>count_mixed</th>
			</tr>
			<tr>
			  <th>user_id</th>
			  <th></th>
			  <th></th>
			  <th></th>
			  <th></th>
			  <th></th>
			  <th></th>
			  <th></th>
			  <th></th>
			  <th></th>
			  <th></th>
			  <th></th>
			  <th></th>
			</tr>
		  </thead>
		  <tbody>
			<tr>
			  <th>50701</th>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0</td>
			  <td>0</td>
			  <td>0</td>
			  <td>0</td>
			</tr>
			<tr>
			  <th>50961</th>
			  <td>1300000.00</td>
			  <td>0.00</td>
			  <td>600000.00</td>
			  <td>0.00</td>
			  <td>1200000.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>2</td>
			  <td>1</td>
			  <td>1</td>
			  <td>0</td>
			</tr>
			<tr>
			  <th>53759</th>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0</td>
			  <td>0</td>
			  <td>0</td>
			  <td>0</td>
			</tr>
			<tr>
			  <th>54759</th>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>2000000.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0</td>
			  <td>1</td>
			  <td>0</td>
			  <td>0</td>
			</tr>
			<tr>
			  <th>61414</th>
			  <td>0.00</td>
			  <td>10000.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>1</td>
			  <td>0</td>
			  <td>0</td>
			  <td>0</td>
			</tr>
		  </tbody>
	</table>
</div>
<div class="desc">After creating the invested and transactions dataframe, then we will merge both dataframe into new_trans and we will be using this dataset in the future.</div>
<pre><code>new_trans = invested_AUM.merge(sum_trans_total, on='user_id')
print(f'Total rows: {new_trans.shape[0]}, columns:{new_trans.shape[1]}')
del invested_AUM, sum_trans_total
new_trans.head()</code>
	Total rows: 8277, columns:22</pre>
<div class="table-wrapper">
	<table>
		<thead>
			<tr style="text-align: right;">
			  <th></th>
			  <th>user_id</th>
			  <th>trans_date</th>
			  <th>Saham_AUM</th>
			  <th>Saham_invested_amount</th>
			  <th>Pasar_Uang_AUM</th>
			  <th>Pasar_Uang_invested_amount</th>
			  <th>Pendapatan_Tetap_AUM</th>
			  <th>Pendapatan_Tetap_invested_amount</th>
			  <th>Campuran_AUM</th>
			  <th>Campuran_invested_amount</th>
			  <th>...</th>
			  <th>Pasar_Uang_transaction_amount_buy</th>
			  <th>Pasar_Uang_transaction_amount_sell</th>
			  <th>Pendapatan_Tetap_transaction_amount_buy</th>
			  <th>Pendapatan_Tetap_transaction_amount_sell</th>
			  <th>Campuran_transaction_amount_buy</th>
			  <th>Campuran_transaction_amount_sell</th>
			  <th>count_saham</th>
			  <th>count_uang</th>
			  <th>count_fixed</th>
			  <th>count_mixed</th>
			</tr>
		  </thead>
		  <tbody>
			<tr>
			  <th>0</th>
			  <td>3786300</td>
			  <td>2021-09-30</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>...</td>
			  <td>0.00</td>
			  <td>10000.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>1</td>
			  <td>1</td>
			  <td>0</td>
			  <td>0</td>
			</tr>
			<tr>
			  <th>1</th>
			  <td>3760891</td>
			  <td>2021-09-30</td>
			  <td>258975.00</td>
			  <td>249864.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>553302.00</td>
			  <td>550000.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>...</td>
			  <td>310000.00</td>
			  <td>410000.00</td>
			  <td>499783.00</td>
			  <td>49783.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>5</td>
			  <td>7</td>
			  <td>7</td>
			  <td>0</td>
			</tr>
			<tr>
			  <th>2</th>
			  <td>4096532</td>
			  <td>2021-09-30</td>
			  <td>13803192.00</td>
			  <td>13352136.00</td>
			  <td>2390277.00</td>
			  <td>2387932.00</td>
			  <td>8134491.00</td>
			  <td>8149154.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>...</td>
			  <td>1937932.00</td>
			  <td>0.00</td>
			  <td>6619154.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>2</td>
			  <td>1</td>
			  <td>2</td>
			  <td>0</td>
			</tr>
			<tr>
			  <th>3</th>
			  <td>2836295</td>
			  <td>2021-09-30</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>...</td>
			  <td>0.00</td>
			  <td>100000.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>1</td>
			  <td>1</td>
			  <td>0</td>
			  <td>0</td>
			</tr>
			<tr>
			  <th>4</th>
			  <td>2839273</td>
			  <td>2021-09-30</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>10028.00</td>
			  <td>10000.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>...</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>40000.00</td>
			  <td>0.00</td>
			  <td>0.00</td>
			  <td>1</td>
			  <td>0</td>
			  <td>1</td>
			  <td>0</td>
			</tr>
		  </tbody>
	</table>
</div>
<!--<div class="desc">Now, we get a new dataset that has been clean and aggregate by users then we will
	continue our investigation for our previous outliers with user age older than 53 years old.
	The first thing we will do is to merge the new dataset with user_outliers to see how many of the outliers contribute with the transaction.</div>
<pre><code>trans_outliers = user_outliers[['user_id', 'user_age']].merge(new_trans, on='user_id')
total_out_transaction = trans_outliers.user_id.nunique()
percentage_out_transaction = (total_out_transaction/transcation_users)
print(f'Total users in outliers making transaction: {total_out_transaction}
	OR {percentage_out_transaction:.2%} from the user that making transaction.')
trans_outliers.head()</code>
	Total users in outliers making transaction: 145 OR 1.75% from the user that making transactions.</pre>
	<div class="table-wrapper">
		<table>
			<thead>
				<tr style="text-align: right;">
				  <th></th>
				  <th>user_id</th>
				  <th>user_age</th>
				  <th>trans_date</th>
				  <th>Saham_AUM</th>
				  <th>Saham_invested_amount</th>
				  <th>Pasar_Uang_AUM</th>
				  <th>Pasar_Uang_invested_amount</th>
				  <th>Pendapatan_Tetap_AUM</th>
				  <th>Pendapatan_Tetap_invested_amount</th>
				  <th>Campuran_AUM</th>
				  <th>Campuran_invested_amount</th>
				  <th>Saham_transaction_amount</th>
				  <th>Pasar_Uang_transaction_amount</th>
				  <th>Pendapatan_Tetap_transaction_amount</th>
				  <th>Campuran_transaction_amount</th>
				</tr>
			  </thead>
			  <tbody>
				<tr>
				  <th>0</th>
				  <td>3816789</td>
				  <td>53</td>
				  <td>2021-09-30</td>
				  <td>297141.00</td>
				  <td>290000.00</td>
				  <td>40235.00</td>
				  <td>40000.00</td>
				  <td>270673.00</td>
				  <td>270000.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>100000.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				</tr>
				<tr>
				  <th>1</th>
				  <td>3049927</td>
				  <td>53</td>
				  <td>2021-09-30</td>
				  <td>41545.00</td>
				  <td>40000.00</td>
				  <td>9997.00</td>
				  <td>10000.00</td>
				  <td>49925.00</td>
				  <td>50000.00</td>
				  <td>910285.00</td>
				  <td>899000.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>149000.00</td>
				</tr>
				<tr>
				  <th>2</th>
				  <td>3836491</td>
				  <td>59</td>
				  <td>2021-09-30</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>10012.00</td>
				  <td>10000.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				</tr>
				<tr>
				  <th>3</th>
				  <td>3783302</td>
				  <td>57</td>
				  <td>2021-09-30</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>107322.00</td>
				  <td>110431.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>-370000.00</td>
				  <td>-100000.00</td>
				  <td>-419569.00</td>
				  <td>0.00</td>
				</tr>
				<tr>
				  <th>4</th>
				  <td>3820160</td>
				  <td>58</td>
				  <td>2021-09-30</td>
				  <td>62351.00</td>
				  <td>60000.00</td>
				  <td>20032.00</td>
				  <td>20000.00</td>
				  <td>145083.00</td>
				  <td>145000.00</td>
				  <td>0.00</td>
				  <td>0.00</td>
				  <td>30000.00</td>
				  <td>0.00</td>
				  <td>75000.00</td>
				  <td>0.00</td>
				</tr>
			  </tbody>
		</table>
	</div>
	<div class="desc">From the total of 264 outliers users, apparently there are only 145 of them making
		transactions or it equal to 1.75% from the total of new transactions' dataset.
		That number is relatively small, which it's okay if we just exclude the outliers from our analysis.
		However, we will double check if they contribute in a big amount of transaction or
		not to avoid removing big investor that hide in the outliers. 
	</div>
<pre><code>idx= ['saham', 'campuran', 'pasar uang', 'pendapatan tetap']
sum_outliers = [trans_outliers.Saham_transaction_amount.max(), trans_outliers.Campuran_transaction_amount.max(),
	trans_outliers.Pasar_Uang_transaction_amount.max(),	trans_outliers.Pendapatan_Tetap_transaction_amount.max()]
sum_full = [new_trans.Saham_transaction_amount.max(), new_trans.Campuran_transaction_amount.max(),
	new_trans.Pasar_Uang_transaction_amount.max(), new_trans.Pendapatan_Tetap_transaction_amount.max()]

X = np.arange(4)
plt.bar(X + 0.00, sum_outliers, width = 0.25, label='max outlier')
plt.bar(X + 0.25, sum_full, width = 0.25, label='max total')
plt.ticklabel_format(useOffset=False, style='plain')
plt.xticks(X, idx)
plt.legend()
plt.title('Comparison max transactions outliers and whole')</code></pre>
<div class="center"><img src="/images/bonds/compare_out.png" alt=""></div>-->
<div class="desc">So we cleaned our transactions' dataset and aggregate the transactions column.
	The next thing we will do is to do a quick exploration for our bonds order dataset before combining with dataset 1 and 2. 
</div>
<h2 class="major" id="dataset3">Bonds Order</h2>
<pre><code>print(f'Total rows: {result.shape[0]}, columns:{result.shape[1]}')
print(f'Total User: {result.user_id.nunique()}')
result.info()</code>
	Total rows: 8484, columns:3
	Total User: 8484
	RangeIndex: 8484 entries, 0 to 8483
	Data columns (total 3 columns):
	#   Column              Non-Null Count  Dtype
	---  ------              --------------  -----
	0   user_id             8484 non-null   int64
	1   flag_order_bond     8484 non-null   int64
	2   bond_units_ordered  8484 non-null   int64
	dtypes: int64(3)</pre>
<div class="desc">Since our problem statement is to find the prediction whether the user will order bonds based on their behaviour.
	We want to see the percentage that users order bonds from the bonds order dataset to see the comparison between each class.</div>
<pre><code>bond_order = result[['user_id', 'flag_order_bond']].groupby('flag_order_bond').count()
fig, ax = plt.subplots(figsize=(5, 5), subplot_kw=dict(aspect="equal"))
wedges, texts, autotexts = ax.pie(bond_order.user_id, autopct=lambda pct: func(pct, bond_order.user_id),
									textprops=dict(color="black"), explode=(0,0.1))
ax.legend(wedges, bond_order.index, title='Flag order bond', loc='upper right')
plt.show()

bond_chart=sns.countplot(x=result["flag_order_bond"])
plt.tight_layout()
plt.show()</code></pre>
<div class="center"><img src="/images/bonds/bonds_pie.png" alt=""></div>
	<div class="desc">It shows that only 40.9% of our users order the Government Bonds. However, we found a difference on our number of users from transactions' dataset and 3. We have 8277 total users in transactions' dataset that making transactions, meanwhile 8484 users in bonds order dataset.
	We will combine transactions' dataset and bonds order to see the details of it.</div>
	<pre><code>trans_3 = result.merge(new_trans, how='left')
print(f'Total combined rows: {trans_3.shape[0]}, columns:{trans_3.shape[1]}')
print(f'Difference total users:{trans_3.user_id.nunique()-transaction_users}')
trans_3.isnull().sum()</code>	Total combined rows: 8484, columns:24
	Difference total users:207

	user_id                                  0
	flag_order_bond                          0
	bond_units_ordered                       0
	trans_date                             207
	Saham_AUM                              207
	Saham_invested_amount                  207
	Pasar_Uang_AUM                         207
	Pasar_Uang_invested_amount             207
	Pendapatan_Tetap_AUM                   207
	Pendapatan_Tetap_invested_amount       207
	Campuran_AUM                           207
	Campuran_invested_amount               207
	Saham_transaction_amount               207
	Pasar_Uang_transaction_amount          207
	Pendapatan_Tetap_transaction_amount    207
	Campuran_transaction_amount            207
	dtype: int64</pre>
	<div class="desc">We left joined our dataset since our bonds order dataset has more rows of data for a better understanding what is the difference.
		There is 8484 rows of data and 16 columns after the merging. We also check how much the difference between both dataset and the null value.
		Our difference number of user between transactions' dataset and 3 is 207 user, it also same with the number of our null values.
		We will try to visualise the user with null values if they ordered bonds or not before we decide to exclude those user.
		</div>
		<pre><code>v = trans_3[trans_3.isnull().any(axis=1)]
v_null = v[['user_id', 'flag_order_bond']].groupby('flag_order_bond').count()
fig, ax = plt.subplots(figsize=(5, 5), subplot_kw=dict(aspect="equal"))
wedges, texts, autotexts = ax.pie(v_null.user_id, autopct=lambda pct: func(pct, v_null.user_id),
	textprops=dict(color="black"), explode=(0,1))
ax.legend(wedges, v_null.index, title='Null flag order bond', loc='upper right')
plt.show()</code></pre>
<div class="center"><img src="/images/bonds/bond_null.png" alt=""></div>
<div class="desc">From the pie chart, we can see only 1 of 207 user ended up order bond from the company.
	Since we don't have any transactional record for the 207 users, it safe to exclude them from our analysis.
Now, we will merging all of our dataset into 1 before we preprocess our data for modelling.
</div>
<pre><code>df1 = new_trans.merge(user, how='inner', on='user_id')
full_data = df1.merge(result, how='inner', on='user_id')
print(f'Total full rows: {full_data.shape[0]}, columns:{full_data.shape[1]}')
print('Null Values:')
full_data.isnull().sum()</code>	Total full rows: 8277, columns:32

	Null Values:
	user_id                                     0
	trans_date                                  0
	Saham_AUM                                   0
	Saham_invested_amount                       0
	Pasar_Uang_AUM                              0
	Pasar_Uang_invested_amount                  0
	Pendapatan_Tetap_AUM                        0
	Pendapatan_Tetap_invested_amount            0
	Campuran_AUM                                0
	Campuran_invested_amount                    0
	Saham_transaction_amount_buy                0
	Saham_transaction_amount_sell               0
	Pasar_Uang_transaction_amount_buy           0
	Pasar_Uang_transaction_amount_sell          0
	Pendapatan_Tetap_transaction_amount_buy     0
	Pendapatan_Tetap_transaction_amount_sell    0
	Campuran_transaction_amount_buy             0
	Campuran_transaction_amount_sell            0
	count_saham                                 0
	count_uang                                  0
	count_fixed                                 0
	count_mixed                                 0
	registration_import_datetime                0
	user_gender                                 0
	user_age                                    0
	user_occupation                             0
	user_income_range                           0
	referral_code_used                          0
	user_income_source                          0
	registration_month                          0
	flag_order_bond                             0
	bond_units_ordered                          0
	dtype: int64</pre>
</p> 
<div class="desc">After we combined the 3 dataset, we have the total of 8277 rows of data and 32 columns. 
	We will create an age group bin into 17-19,20-29,30-39 and so on instead of user_age.</div>
<pre><code>bins = [17, 20, 30, 40, 50, 60, 70, 80, 100]
labels = ['17-19','20-29','30-39', '40-49', '50-59', '60-69', '70-79', '80+']
full_data['age_group'] = pd.cut(full_data['user_age'], bins, labels = labels,include_lowest = True)
full_data.drop(['user_age'], axis=1, inplace=True)
full_data.age_group.unique()
</code>
	['20-29', '40-49', '30-39', '50-59', '17-19', '60-69', '70-79', '80+']
	Categories (8, object): ['17-19' < '20-29' < '30-39' < '40-49' < '50-59' < '60-69' < '70-79' < '80+']</pre>
<pre><code>trans_group = full_data[['age_group', 'Saham_transaction_amount_buy',
	'Saham_transaction_amount_sell', 'Pasar_Uang_transaction_amount_buy',
	'Pasar_Uang_transaction_amount_sell',
	'Pendapatan_Tetap_transaction_amount_buy',
	'Pendapatan_Tetap_transaction_amount_sell',
	'Campuran_transaction_amount_buy', 'Campuran_transaction_amount_sell']].groupby('age_group').sum()

trans_group.plot(title='Summary transaction by age group', figsize=(8,5))
plt.ticklabel_format(axis='y', style='plain')
plt.show()</code></pre>
<div class="center"><img src="/images/bonds/trans_age.png" alt=""></div>
<div class="desc">When we visualise the amount of transaction mapped with the age group, we can see that the age group 20-29 years old contribute the most transactions,
	and it started to slow down until as the user aged. <br>
Then we will check the correlation from each of our features by ploting correlation matrix.</div>
<pre><code>fig, ax = plt.subplots(figsize=(25,10))  
sns.heatmap(full_data.corr(), annot = True, ax=ax, cmap = 'Blues')
plt.title("DataCorrelation")
plt.show()</code></pre>
<div class="center"><img src="/images/bonds/correlation_matrix.png" alt=""style='width: 100%;'></div>
<div class="desc">The correlation matrix show that AUM and Invested column has a perfect positive correlation between each other as well as buying transactions.
	Furthermore, bond_units_ordered also has a positif correlation with flag_order_bond. So, we will be dropping one of the features to avoid multicollinearity in the model performance.
</div>
<pre><code>pos_corr = ['Saham_AUM', 'Pasar_Uang_AUM', 'Pendapatan_Tetap_AUM', 'Campuran_AUM', 'Saham_transaction_amount_buy',
	'Pasar_Uang_transaction_amount_buy', 'Pendapatan_Tetap_transaction_amount_buy', 'Campuran_transaction_amount_buy',
	'bond_units_ordered']
full_data.drop(pos_corr, axis=1, inplace=True)</code></pre>
<h2 class="major" id="preprocessing">Preprocessing</h2>
<div class="desc">So, we will convert our categorical data into numerical. We will print out the unique value from non numerical data.
	Moreover, we will remove column transaction date, registration month, and user id.
</div>
<pre><code>for x in full_data:
	uniqueValues = full_data[x].unique()
	n_values = len(uniqueValues)
	if full_data[x].dtypes == object:
		print(f'Column: {x} -- total unique value: ({n_values}) {uniqueValues}')</code>
	Column: user_gender -- total unique value: (2) ['Male' 'Female']
	Column: user_occupation -- total unique value: (9) ['Pelajar' 'Swasta' 'Others' 'Pengusaha' 'IRT' 'Guru' 'Pensiunan' 'PNS'
	'TNI/Polisi']
	Column: user_income_range -- total unique value: (6) ['< 10 Juta' 'Rp 10 Juta - 50 Juta' '> Rp 100 Juta - 500 Juta'
	'> Rp 500 Juta - 1 Miliar' '> Rp 50 Juta - 100 Juta' '> Rp 1 Miliar']
	Column: referral_code_used -- total unique value: (2) ['used referral' 'None']
	Column: user_income_source -- total unique value: (10) ['Keuntungan Bisnis' 'Gaji' 'Lainnya' 'Warisan' 'Undian'
	'Dari Orang Tua / Anak' 'Tabungan' 'Hasil Investasi' 'Dari Suami / istri'
	'Bunga Simpanan']</pre>
	<div class="desc">From the unique value details, it clearly shows that user_income_range is ordinal category. So we will be using label encoder to convert them into numerical data, meanwhile one hot encoding for the rest.</div>
<pre><code>full_data.drop(['trans_date', 'registration_month', 'user_id'], axis=1, inplace=True)
one_hot_var = ['user_gender','user_occupation', 'referral_code_used', 'user_income_source']
one_hot = pd.get_dummies(full_data, columns = one_hot_var)

from sklearn.preprocessing import LabelEncoder

labelencoder = LabelEncoder()

one_hot['registration_import_datetime'] = labelencoder.fit_transform(one_hot['registration_import_datetime'])
one_hot['age_group'] = labelencoder.fit_transform(one_hot['age_group'])
one_hot['user_income_range'] = labelencoder.fit_transform(one_hot['user_income_range'])
one_hot.info()</code>
	Int64Index: 8277 entries, 0 to 8276
	Data columns (total 39 columns):
	 #   Column                                    Non-Null Count  Dtype  
	---  ------                                    --------------  -----  
	 0   Saham_invested_amount                     8277 non-null   float64
	 1   Pasar_Uang_invested_amount                8277 non-null   float64
	 2   Pendapatan_Tetap_invested_amount          8277 non-null   float64
	 3   Campuran_invested_amount                  8277 non-null   float64
	 4   Saham_transaction_amount_sell             8277 non-null   float64
	 5   Pasar_Uang_transaction_amount_sell        8277 non-null   float64
	 6   Pendapatan_Tetap_transaction_amount_sell  8277 non-null   float64
	 7   Campuran_transaction_amount_sell          8277 non-null   float64
	 8   count_saham                               8277 non-null   int32  
	 9   count_uang                                8277 non-null   int32  
	 10  count_fixed                               8277 non-null   int32  
	 11  count_mixed                               8277 non-null   int32  
	 12  registration_import_datetime              8277 non-null   int32  
	 13  user_income_range                         8277 non-null   int32  
	 14  flag_order_bond                           8277 non-null   int64  
	 15  age_group                                 8277 non-null   int32  
	 16  user_gender_Female                        8277 non-null   uint8  
	 17  user_gender_Male                          8277 non-null   uint8  
	 18  user_occupation_Guru                      8277 non-null   uint8  
	 19  user_occupation_IRT                       8277 non-null   uint8  
	 20  user_occupation_Others                    8277 non-null   uint8  
	 21  user_occupation_PNS                       8277 non-null   uint8  
	 22  user_occupation_Pelajar                   8277 non-null   uint8  
	 23  user_occupation_Pengusaha                 8277 non-null   uint8  
	 24  user_occupation_Pensiunan                 8277 non-null   uint8  
	 25  user_occupation_Swasta                    8277 non-null   uint8  
	 26  user_occupation_TNI/Polisi                8277 non-null   uint8  
	 27  referral_code_used_None                   8277 non-null   uint8  
	 28  referral_code_used_used referral          8277 non-null   uint8  
	 29  user_income_source_Bunga Simpanan         8277 non-null   uint8  
	 30  user_income_source_Dari Orang Tua / Anak  8277 non-null   uint8  
	 31  user_income_source_Dari Suami / istri     8277 non-null   uint8  
	 32  user_income_source_Gaji                   8277 non-null   uint8  
	 33  user_income_source_Hasil Investasi        8277 non-null   uint8  
	 34  user_income_source_Keuntungan Bisnis      8277 non-null   uint8  
	 35  user_income_source_Lainnya                8277 non-null   uint8  
	 36  user_income_source_Tabungan               8277 non-null   uint8  
	 37  user_income_source_Undian                 8277 non-null   uint8  
	 38  user_income_source_Warisan                8277 non-null   uint8  </pre>
<div class="desc">After we convert our non numerical data into numeric, we can see our dataset shape is changed to 8277 rows and 39 columns.
	We will use the current feature to create our model using multiple classification algorithm and evaluate which one give the best performance.
	So, we will take out the target variable which is flag_order_bond from our dataset and divided them into training (60% of total data) 40% for validation and testing.
	Also, we will scale our data between 0 and 1 using minmaxscaler from scikit-learn.
</div>
<pre><code>x_v1 = one_hot.drop(['flag_order_bond'], axis=1)
y_v1 = one_hot['flag_order_bond'].copy()
</code></pre>
<pre>Function to split data into train, val and test also scaling<code>from sklearn.model_selection import train_test_split
from sklearn.preprocessing import MinMaxScaler

def split_scaled(x,y):
	xtrain, xtemp, ytrain, ytemp = train_test_split(x, y, train_size=0.6, random_state=3)
	xvalid, xtest, yvalid, ytest = train_test_split(xtemp, ytemp, test_size=0.5, random_state=3)
	scale = MinMaxScaler()

	xtrain_scaled = scale.fit_transform(xtrain)
	xvalid_scaled = scale.fit_transform(xvalid)
	xtest_scaled = scale.fit_transform(xtest)
	return xtrain_scaled, ytrain, xvalid_scaled, yvalid, xtest_scaled, ytest</code></pre>

<pre>Function to evaluate models<code>from sklearn.metrics import ConfusionMatrixDisplay, accuracy_score, confusion_matrix, mean_squared_error, r2_score
score_comp = []
def eval(model, name, x1, y1, x2, y2, x3,y3):
	predtrain = model.predict(x1)
	predvalid = model.predict(x2)
	predtest = model.predict(x3)
	acctest = (accuracy_score(y3, predtest))*100
	accvalid = (accuracy_score(y2, predvalid))*100
	acctrain = (accuracy_score(y1, predtrain))*100
	overfit = acctrain - acctest
	
	rmse= (mean_squared_error(ytest,predtest))**(1/2)
	r2 = r2_score(ytest, predtest)
	print(f'Training accuracy: {acctrain} \nValidation accuracy: {accvalid} \nTesting accuracy: {acctest} \nOverfitting: {overfit}')
	print('RMSE test: %.3f' % rmse)
	print('R^2 test: %.3f' % r2)
	score_comp.append([name, acctrain, accvalid, acctest, rmse, r2])</code></pre>
<h2 class="major" id="logreg1">Model 1 - Logistic Regression</h2>
<div class="desc">The first model that we will implement is using Logistic Regression with our original dataset. Furthermore, a function to evaluate our model will be created for easy comparisson.</div>
<pre><code>xtrain, ytrain, xvalid, yvalid, xtest, ytest = split_scaled(x_v1, y_v1)

from sklearn.linear_model import LogisticRegression

logreg = LogisticRegression()
logreg.fit(xtrain, ytrain)
eval(logreg, 'logreg1', xtrain, ytrain, xvalid, yvalid, xtest, ytest)</code>
	Training accuracy: 63.25010068465566 
	Validation accuracy: 61.51057401812688 
	Testing accuracy: 62.01690821256038 
	Overfitting: 1.2331924720952827
	RMSE test: 0.616
	R^2 test: -0.589</pre>
		</div>
					</section>
			</div>

		<!-- Footer -->
		<footer id="footer" class="wrapper style1-alt">
			<div class="inner">
				<ul class="menu">
					<li>&copy; Devy Ratnasari</li>
					<li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
				</ul>
			</div>
		</footer>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body></html>